# skill-from-notebook & SkillBookLM 设计方案

## 命名说明

| 层级 | 名字 | 说明 |
|-----|-----|-----|
| Claude Code Skill | **skill-from-notebook** | 开发者/Power User 使用 |
| 独立产品 | **SkillBookLM** | 面向所有用户的完整产品 |

命名策略：与 NotebookLM 形成对照，用户一眼就懂定位差异。

## 核心理念

**NotebookLM = 帮你理解 (Passive Understanding)**
**SkillBookLM = 帮你会 (Active Mastery)**

NotebookLM 帮助用户理解材料内容，但理解 ≠ 掌握。SkillBookLM 的目标是将文档中的方法论提取出来，生成可执行的 Skill，让用户真正"会做"。

---

## Part 1: skill-from-notebook (Claude Code Skill)

### 1.1 定位

作为 `skill-from-masters` 系列的一部分，与现有 skill 形成完整生态：
- `search-skill` - 搜索已有的 Skill
- `skill-from-github` - 从 GitHub 项目生成 Skill
- `skill-from-notebook` - 从文档/笔记生成 Skill

### 1.2 输入源

| 输入类型 | 处理方式 | 优先级 |
|---------|---------|-------|
| 本地文档 | PDF, Word, Markdown, 文本文件直接读取 | P0 |
| 网页链接 | WebFetch 获取内容（仅文本） | P0 |
| YouTube 视频 | 优先使用 yt-dlp 获取字幕，无字幕时用 Whisper 转录 | P1 |
| 音频文件 | Whisper 转录（支持 mp3, wav, m4a, ogg 等） | P1 |
| 图片 | Claude Vision 理解图片内容 | P2 |
| 论文 | PDF 解析 + 结构化提取 | P0 |
| NotebookLM 笔记链接 | 通过浏览器自动化获取笔记内容（见 1.5.3） | P1 |
| 成品范例 | 文章、方案、PPT、代码等产出物，逆向提取方法论 | P0 |

> **参考 NotebookLM 限制**: 每个 source 最多 500,000 字或 200MB，每个 notebook 最多 50 个 sources

### 1.3 核心工作流

```
┌─────────────────┐
│   Input Source  │  (文档/URL/视频/NotebookLM笔记/成品范例)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Content Parse  │  提取文本、结构、关键信息
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Input Type     │  识别输入类型：
│  Detection      │  - 方法论文档 (显式方法论)
│                 │  - 成品范例 (隐式方法论)
└────────┬────────┘
         │
         ├─────────────────────────────────┐
         │                                 │
         ▼ [方法论文档]                     ▼ [成品范例]
┌─────────────────┐               ┌─────────────────┐
│ Methodology     │               │ Reverse         │
│ Extraction      │               │ Engineering     │
│                 │               │                 │
│ 识别方法论类型： │               │ 逆向分析：       │
│ - How-to        │               │ - 结构拆解       │
│ - Framework     │               │ - 质量特征提取   │
│ - Decision      │               │ - 方法论逆向     │
│ - Checklist     │               │ - 技巧总结       │
└────────┬────────┘               └────────┬────────┘
         │                                 │
         ├─────────────────────────────────┘
         │
         ▼
┌─────────────────┐
│ Skill Structure │  提取/生成核心要素：
│ Extraction      │  - 适用场景 (When to use)
│                 │  - 执行步骤 (Steps)
│                 │  - 关键判断点 (Decision points)
│                 │  - 质量标准 (Quality criteria)
│                 │  - 常见错误 (Common pitfalls)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ SKILL.md        │  生成标准化 Skill 文档
│ Generation      │  符合 skill-creator 规范
└─────────────────┘
```

### 1.4 核心逻辑详解

这是整个系统最关键的部分：如何从文档中提取可执行的方法论。

#### 1.4.0 Step 0: 输入类型识别

**核心问题**: 用户输入的内容可能是两种完全不同的类型，需要走不同的处理流程。

```
用户输入
    │
    ▼
┌─────────────────────────────────────────────────────────┐
│                    输入类型判断                          │
├─────────────────────────────────────────────────────────┤
│ A. 方法论文档  → 现有流程（提取显式方法论）               │
│ B. 成品范例    → 新流程（逆向工程方法论）                 │
│ C. 不适合     → 告知用户                                │
└─────────────────────────────────────────────────────────┘
```

**两种学习路径**:

| 类型 | 学习方式 | 处理方式 |
|-----|---------|---------|
| 方法论文档 | 从**教程**中学（显式方法论） | "如何做X" → 提取步骤 |
| 成品范例 | 从**范例**中学（隐式方法论） | "X的成品" → 逆向工程出步骤 |

这对应人类学习的两种核心方式：
1. **看教程** - 有人告诉你怎么做
2. **看范例** - 模仿优秀作品，自己总结出规律

**判断标准**:

| 类型 | 特征 |
|-----|-----|
| 方法论文档 | 有"如何"、"步骤"、"方法"等词；有编号列表；有指导性语气；意图是"教你做" |
| 成品范例 | 是一个完整的作品；没有教学意图；是"做出来的东西"而非"教你做的文档" |
| 不适合 | 纯叙事内容、新闻、观点文章、会议记录等 |

**成品范例的常见形式**:
- 写的一篇文章（技术博客、产品文案、报告等）
- 做的资料、方案、PPT
- 论文、研究报告
- 代码项目、架构设计
- 其他任何产出物（output）

> 如果识别为**成品范例**，跳转到 1.4.6 从范例逆向提取；如果是**方法论文档**，继续 Step 1。

#### 1.4.1 Step 1: 文档适合性判断

**核心问题**: 不是所有文档都适合生成 Skill。

| 文档类型 | 示例 | 适合生成 Skill？ |
|---------|-----|-----------------|
| 教程/指南 | 《如何写好 Git Commit》 | ✅ 非常适合 |
| 方法论文章 | 《SWOT 分析法》 | ✅ 适合 |
| 技术文档 | API 使用说明 | ✅ 适合 |
| 概念解释 | 《什么是微服务》 | ⚠️ 需要判断是否有可执行步骤 |
| 叙事性内容 | 《人类简史》章节 | ❌ 不适合 |
| 新闻/观点 | 博客评论文章 | ❌ 不适合 |
| 会议记录 | 讨论纪要 | ❌ 不适合 |

**判断标准** (满足至少 2 项才适合生成 Skill):

```
□ 有明确的目标/结果 - 文档描述了要达成什么
□ 有可重复的步骤/流程 - 存在可以按顺序执行的动作
□ 有判断标准/质量要求 - 说明了什么是"做好了"
□ 有条件/场景说明 - 指出了什么情况下应该这样做
```

**如果不适合**: 明确告知用户，并解释原因。

#### 1.4.2 Step 2: 识别 Skill 类型

根据文档内容特征，识别属于哪种类型的 Skill：

```
┌─────────────────────────────────────────────────────────────┐
│  A. 操作型 (How-to)                                         │
│                                                             │
│  特征：                                                     │
│  - 明确的步骤序列 (Step 1, Step 2...)                       │
│  - 有输入和输出                                             │
│  - 可以机械地重复执行                                        │
│                                                             │
│  示例：                                                     │
│  - 如何部署 Docker 容器                                     │
│  - 如何配置 CI/CD 流水线                                    │
│  - 如何进行 Code Review                                     │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  B. 决策型 (Decision)                                       │
│                                                             │
│  特征：                                                     │
│  - 条件判断 (如果...那么...)                                │
│  - 多个选项和权衡                                           │
│  - 需要根据情况选择不同路径                                  │
│                                                             │
│  示例：                                                     │
│  - 如何选择数据库 (SQL vs NoSQL)                            │
│  - 如何选择前端框架                                         │
│  - 何时使用微服务 vs 单体架构                               │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  C. 框架型 (Framework)                                      │
│                                                             │
│  特征：                                                     │
│  - 提供思维模型或分析维度                                    │
│  - 通用性强，可应用于多种场景                                │
│  - 重点是"怎么想"而非"怎么做"                               │
│                                                             │
│  示例：                                                     │
│  - SWOT 分析法                                              │
│  - 5W1H 分析法                                              │
│  - 第一性原理思维                                           │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  D. 检查型 (Checklist)                                      │
│                                                             │
│  特征：                                                     │
│  - 验证清单，确保不遗漏                                      │
│  - 有明确的通过/不通过标准                                   │
│  - 用于质量保证或完成度检查                                  │
│                                                             │
│  示例：                                                     │
│  - Code Review 检查清单                                     │
│  - 上线前检查清单                                           │
│  - 安全审计检查项                                           │
└─────────────────────────────────────────────────────────────┘
```

#### 1.4.3 Step 3: 按类型提取结构

不同类型的 Skill 需要提取不同的结构元素：

| Skill 类型 | 需要提取的元素 |
|-----------|--------------|
| **操作型** | 前置条件、步骤序列、每步的输入输出、预期最终结果、常见错误 |
| **决策型** | 决策点、判断条件、各选项的优劣、推荐选项、决策树/流程图 |
| **框架型** | 核心概念、分析维度、应用场景、使用示例、局限性 |
| **检查型** | 检查项列表、每项的判断标准、优先级、常见遗漏项 |

#### 1.4.4 Step 4: 生成 SKILL.md

根据 Skill 类型使用对应的模板生成最终文档。

**操作型模板**:
```markdown
## 适用场景
[何时使用这个 Skill]

## 前置条件
- [需要准备什么]

## 执行步骤
1. [Step 1] - [预期结果]
2. [Step 2] - [预期结果]
...

## 验证方法
[如何确认做对了]

## 常见问题
- [问题1]: [解决方案]
```

**决策型模板**:
```markdown
## 适用场景
[何时需要做这个决策]

## 决策因素
| 因素 | 考量点 |
|-----|-------|
| ... | ...   |

## 决策树
[条件] → [选择A]
[条件] → [选择B]

## 各选项对比
| 选项 | 优点 | 缺点 | 适用场景 |
|-----|-----|-----|---------|

## 推荐默认选择
[大多数情况下的推荐]
```

**框架型模板**:
```markdown
## 框架概述
[这个框架是什么，用来做什么]

## 核心维度
1. [维度1]: [说明]
2. [维度2]: [说明]

## 使用方法
[如何应用这个框架]

## 应用示例
[具体案例]

## 局限性
[什么情况下不适用]
```

**检查型模板**:
```markdown
## 适用场景
[何时使用这个检查清单]

## 检查清单
### [类别1]
- [ ] [检查项] - [判断标准]
- [ ] [检查项] - [判断标准]

### [类别2]
- [ ] [检查项] - [判断标准]

## 常见遗漏
[容易忘记检查的项目]
```

#### 1.4.5 实现方式：Prompt Engineering

以上逻辑通过 LLM Prompt 实现，而非硬编码规则：

```markdown
# 方法论提取 Prompt

你是一个方法论提取专家。给定一个文档，按以下步骤处理：

## Step 1: 判断适合性
分析文档是否描述了"如何做某事"。检查：
- 是否有明确的目标/结果？
- 是否有可重复的步骤/流程？
- 是否有判断标准/质量要求？

如果都没有，回复："该文档不适合生成 Skill，因为..."

## Step 2: 识别类型
判断属于哪种类型：
- 操作型：有明确步骤序列
- 决策型：有条件判断和选择
- 框架型：提供思维模型
- 检查型：是验证清单

## Step 3: 提取结构
根据类型提取对应元素（见上表）

## Step 4: 生成 Skill
使用对应模板生成 SKILL.md
```

#### 1.4.6 从范例逆向提取 Skill

当输入是一个**成品范例**而非方法论文档时，需要通过逆向工程提取出"如何生成此类产出"的 Skill。

**逆向提取流程**:

```
┌─────────────────┐
│  用户输入成品    │  (文章/PPT/方案/代码/论文)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  成品类型识别    │  这是什么类型的产出物？
│                 │  (技术博客/产品方案/学术论文/...)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  结构分析        │  这个成品由哪些部分组成？
│                 │  各部分的作用是什么？
│                 │  各部分的比例和顺序？
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  质量特征提取    │  这个成品"好"在哪里？
│                 │  有哪些值得学习的特点？
│                 │  与普通作品的差异是什么？
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  方法论逆向      │  要产出这样的作品，
│                 │  需要经过哪些步骤？
│                 │  需要做哪些决策？
│                 │  需要注意哪些要点？
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Skill 生成      │  生成可复用的制作指南
└─────────────────┘
```

**逆向提取的核心问题**:

| 分析维度 | 需要回答的问题 |
|---------|--------------|
| 结构 | 这个作品分几个部分？各部分承担什么功能？ |
| 风格 | 语气、用词、表达方式有什么特点？ |
| 技巧 | 用了哪些手法让内容更有效？ |
| 逻辑 | 信息的组织和推进方式是什么？ |
| 细节 | 有哪些容易被忽略但很重要的小处理？ |

**具体示例 - 从技术博客逆向提取**:

输入: 用户提供一篇写得很好的技术博客

```
结构分析:
├── 开头：用一个真实痛点切入（2-3 句）
├── 问题描述：3 句话讲清楚问题本质
├── 解决方案：先给结论，再展开细节
├── 代码示例：每段代码 < 20 行，有注释
├── 踩坑记录：列出 3 个常见错误及解决方案
└── 总结：一句话 takeaway + 延伸阅读

质量特征:
- 标题包含具体技术 + 解决的问题
- 每个段落只讲一件事
- 代码和文字比例约 40:60
- 有"我当时..."的个人经历增加可信度
- 用类比解释抽象概念

逆向出的 Skill: "如何写一篇技术博客"
```

**逆向提取模板**:

```markdown
## 成品类型
[这是什么类型的产出物]

## 结构拆解
1. [部分1]: [作用] - [占比]
2. [部分2]: [作用] - [占比]
...

## 质量特征
- [特征1]: [具体表现]
- [特征2]: [具体表现]
...

## 制作步骤（逆向推导）
1. [Step 1]: [要做什么] - [要点]
2. [Step 2]: [要做什么] - [要点]
...

## 关键决策点
- [决策1]: [选项A] vs [选项B] - [本范例的选择及原因]
...

## 可复用的技巧
- [技巧1]: [如何应用]
- [技巧2]: [如何应用]

## 检查清单
- [ ] [检查项1]
- [ ] [检查项2]
```

**多范例学习（进阶）**:

当用户提供多个同类型的范例时，可以进行比较分析：

```
范例 A ──┐
范例 B ──┼──> 共性提取 ──> 核心方法论
范例 C ──┘        │
                  ▼
              差异分析 ──> 风格变体/可选技巧
```

这种方式可以提取出更通用、更robust的 Skill。

### 1.5 技术实现

#### 1.5.1 NotebookLM 集成（可选）

借鉴 `notebooklm-skill` 的实现方式：
- 使用 Patchright（undetected Playwright fork）绕过 bot 检测
- 调用用户本地 Chrome 进行自动化
- 存储 cookies 保持登录状态

```python
# 核心依赖
# patchright - 绕过 Cloudflare/bot 检测
# browser automation - 与 NotebookLM 交互
```

**优点**: 可以利用 NotebookLM 的 Audio Overview、问答等高级功能
**限制**: 依赖浏览器自动化，仅适用于 Claude Code 环境

#### 1.5.2 独立文档理解（推荐）

不依赖 NotebookLM，自己实现文档理解：

```python
# 文档解析
- pypdf / pdfplumber  # PDF 解析
- python-docx         # Word 文档
- markdownify        # HTML 转 Markdown

# YouTube 处理（两级策略）
- yt-dlp             # 优先获取 YouTube 字幕（用户上传或自动生成）
- openai-whisper     # 无字幕时转录音频（fallback）

# 音频处理
- openai-whisper     # 音频转文字
- 支持格式: mp3, wav, m4a, ogg, flac, aac

# 图片理解
- Claude Vision API  # 理解图片中的方法论/流程图/示意图

# 结构提取
- 段落分析
- 标题层级识别
- 列表/步骤提取
- 关键词/概念识别
```

**YouTube 处理流程**:
```
YouTube URL
    │
    ▼
┌─────────────────┐
│ yt-dlp 获取字幕 │
└────────┬────────┘
         │
    有字幕？
    ├─ Yes ──> 直接使用字幕文本
    │
    └─ No ───> yt-dlp 下载音频 ──> Whisper 转录
```

#### 1.5.3 NotebookLM 笔记链接处理

当用户提供 NotebookLM 笔记链接时，系统可以利用 NotebookLM 已有的内容理解能力，在此基础上进行 Skill 提取。

**输入格式**:
```
https://notebooklm.google.com/notebook/[notebook-id]
```

**处理流程**:
```
NotebookLM 笔记链接
         │
         ▼
┌─────────────────┐
│ 浏览器自动化     │  使用 Patchright 绕过 bot 检测
│ 登录 & 访问     │  复用用户本地 Chrome cookies
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 提取笔记内容     │  获取：
│                 │  - 原始 sources 列表
│                 │  - 笔记/摘要内容
│                 │  - Audio Overview 文字稿（如有）
│                 │  - 用户添加的 notes
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 内容整合        │  合并所有内容，保留结构
└────────┬────────┘
         │
         ▼
    进入标准 Skill 提取流程
```

**可提取的内容**:

| NotebookLM 元素 | 提取方式 | 价值 |
|----------------|---------|------|
| Sources 列表 | 获取原文档链接/标题 | 追溯原始来源 |
| 生成的摘要 | 直接提取文本 | 已整理的核心内容 |
| Audio Overview | 提取文字稿 | 对话式的内容梳理 |
| 用户 Notes | 提取用户笔记 | 用户已标记的重点 |
| FAQ/问答 | 提取问答对 | 关键概念澄清 |

**优势**:
- 利用 NotebookLM 已做的内容理解工作
- 用户可能已经整理过笔记，质量更高
- Audio Overview 的对话形式可能包含更易理解的解释

**技术依赖**:
```python
# 借鉴 notebooklm-skill 的实现
from patchright.sync_api import sync_playwright

# 核心步骤
1. 启动带用户 profile 的 Chrome
2. 访问 NotebookLM 笔记链接
3. 等待页面加载完成
4. 提取 DOM 中的笔记内容
5. 结构化处理后返回
```

**限制**:
- 需要用户已登录 Google 账号
- 依赖浏览器自动化，可能受 NotebookLM UI 变化影响
- 仅适用于 Claude Code 本地环境

### 1.6 Skill 输出格式

> **注意**: 这是最终输出的通用格式，`核心方法论` 部分根据 Skill 类型（见 1.4.4）或逆向提取结果（见 1.4.6）填充对应的结构。

#### 1.6.1 从方法论文档提取的格式

```markdown
# [Skill Name] - Generated from Notes

## Source
- 原始文档: [document name/URL]
- 提取时间: [timestamp]
- 方法论类型: [How-to/Framework/Decision/Checklist]

## 适用场景
[When should this skill be invoked]

## 核心方法论
[Extracted methodology in structured format]

## 执行步骤
1. [Step 1]
2. [Step 2]
...

## 质量检查点
- [ ] [Checkpoint 1]
- [ ] [Checkpoint 2]

## 常见陷阱
- [Pitfall 1]: [How to avoid]
- [Pitfall 2]: [How to avoid]

## 参考资料
[Original source links]
```

#### 1.6.2 从成品范例逆向提取的格式

```markdown
# [Skill Name] - Reverse Engineered from Example

## Source
- 范例来源: [example name/URL]
- 提取时间: [timestamp]
- 成品类型: [技术博客/产品方案/学术论文/...]

## 适用场景
[When to create this type of output]

## 范例结构拆解
1. [部分1]: [作用] - [占比约X%]
2. [部分2]: [作用] - [占比约X%]
...

## 质量特征（从范例中学到的）
- [特征1]: [具体表现]
- [特征2]: [具体表现]
...

## 制作步骤（逆向推导）
1. [Step 1]: [要做什么] - [要点/技巧]
2. [Step 2]: [要做什么] - [要点/技巧]
...

## 关键决策点
- [决策1]: [选项及建议]
- [决策2]: [选项及建议]

## 可复用的技巧
- [技巧1]: [如何应用]
- [技巧2]: [如何应用]

## 检查清单
- [ ] [检查项1]
- [ ] [检查项2]

## 参考范例
[Original example links/references]
```

### 1.7 SKILL.md 定义

```markdown
---
description: "从文档、笔记、网页或成品范例中提取方法论，生成可执行的 Skill"
invocation: "当用户想要将学习材料或优秀范例转化为可执行技能时使用"
---

# skill-from-notebook

## Workflow

1. **获取输入**
   - 接收用户提供的文档路径、URL、或内容
   - 支持格式: PDF, Word, Markdown, 网页, YouTube, 音频, 图片
   - 支持 NotebookLM 笔记链接: 提取笔记内容、摘要、Audio Overview
   - 支持成品范例: 文章、方案、PPT、论文、代码等产出物

2. **内容解析**
   - 提取文本内容
   - 识别文档结构（标题、段落、列表）
   - 标记关键概念和术语

3. **输入类型识别**
   - 判断是"方法论文档"还是"成品范例"
   - 方法论文档：有教学意图，显式描述"如何做"
   - 成品范例：是完整作品，需要逆向提取方法论

4. **方法论提取**
   - **方法论文档路径**：
     - 判断文档类型：操作型、决策型、框架型、检查型
     - 提取核心方法论元素
     - 识别步骤、条件、输出
   - **成品范例路径**：
     - 结构拆解：分析作品组成部分
     - 质量特征提取：识别优秀之处
     - 方法论逆向：推导出制作步骤和技巧

5. **Skill 生成**
   - 按照 skill-creator 规范生成 SKILL.md
   - 包含完整的执行指南
   - 添加质量检查点和常见陷阱

6. **验证与优化**
   - 检查生成的 Skill 是否完整
   - 询问用户是否需要调整
   - 保存到指定目录
```

---

## Part 2: SkillBookLM (独立产品)

### 2.1 产品定位

一个类似 NotebookLM 的 AI 笔记产品，但输出不是"理解"而是"技能"：

| 特性 | NotebookLM | SkillBookLM |
|-----|------------|----------------|
| 输入 | 文档、网页、视频 | 相同 |
| 核心功能 | Audio Overview、问答 | Skill 生成、实践指导 |
| 输出 | 播客、摘要、PPT | 可执行 Skill、练习计划 |
| 价值主张 | 帮你理解 | 帮你会 |

### 2.2 技术架构

```
┌─────────────────────────────────────────────────────────┐
│                    Frontend (Web App)                    │
│  - Document Upload   - Skill Library   - Practice Mode  │
└─────────────────────────┬───────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                    API Gateway                           │
│  - Authentication   - Rate Limiting   - Routing         │
└─────────────────────────┬───────────────────────────────┘
                          │
         ┌────────────────┼────────────────┐
         ▼                ▼                ▼
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  Document   │  │   Skill     │  │  Practice   │
│  Service    │  │  Generator  │  │  Engine     │
└──────┬──────┘  └──────┬──────┘  └──────┬──────┘
       │                │                │
       ▼                ▼                ▼
┌─────────────────────────────────────────────────────────┐
│                    LLM Backend                           │
│  - Claude API   - Custom Prompts   - Fine-tuning        │
└─────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                    Data Layer                            │
│  - PostgreSQL (用户/Skill)  - S3 (文档存储)  - Redis     │
└─────────────────────────────────────────────────────────┘
```

### 2.3 核心模块

#### 2.3.1 Document Service（文档服务）

```python
# 文档理解模块 - 不依赖 NotebookLM
class DocumentProcessor:
    """
    支持多种文档格式的解析和理解
    """

    def parse(self, source: str) -> Document:
        """解析文档，返回结构化内容"""
        pass

    def extract_structure(self, doc: Document) -> Structure:
        """提取文档结构：标题、段落、列表"""
        pass

    def identify_methodology(self, doc: Document) -> MethodologyType:
        """识别方法论类型"""
        pass

# 支持的输入格式
SUPPORTED_FORMATS = {
    'pdf': PDFParser,       # pdfplumber / PyMuPDF
    'docx': DocxParser,     # python-docx
    'markdown': MarkdownParser,
    'html': HTMLParser,     # beautifulsoup + markdownify
    'youtube': YouTubeParser,  # yt-dlp (字幕优先) + Whisper (fallback)
    'audio': AudioParser,   # Whisper (mp3, wav, m4a, ogg, flac, aac)
    'image': ImageParser,   # Claude Vision API
}
```

#### 2.3.2 Skill Generator（技能生成器）

```python
class SkillGenerator:
    """
    从解析后的文档生成可执行 Skill
    """

    def generate(self, doc: Document) -> Skill:
        """
        生成 Skill 的核心流程：
        1. 识别方法论类型
        2. 提取核心步骤
        3. 识别关键判断点
        4. 生成质量标准
        5. 总结常见陷阱
        """
        pass

    def validate(self, skill: Skill) -> ValidationResult:
        """验证生成的 Skill 是否完整、可执行"""
        pass
```

#### 2.3.3 Practice Engine（练习引擎）

这是区别于 NotebookLM 的核心功能：

```python
class PracticeEngine:
    """
    帮助用户通过练习掌握 Skill
    """

    def create_exercise(self, skill: Skill) -> Exercise:
        """根据 Skill 生成练习题"""
        pass

    def simulate_scenario(self, skill: Skill) -> Scenario:
        """创建模拟场景让用户实践"""
        pass

    def evaluate_attempt(self, attempt: Attempt) -> Feedback:
        """评估用户的练习结果"""
        pass

    def track_progress(self, user: User, skill: Skill) -> Progress:
        """追踪用户的掌握进度"""
        pass
```

### 2.4 用户体验流程

```
1. 上传文档
   └─> "我想学习这本书中的谈判技巧"

2. AI 分析
   └─> 识别出 5 个核心方法论
       - BATNA 分析法
       - 锚定效应运用
       - 让步策略
       - 沉默技巧
       - 共赢框架

3. 生成 Skill
   └─> 每个方法论生成一个可执行 Skill
       包含：适用场景、步骤、检查点、陷阱

4. 实践模式
   └─> "模拟一个薪资谈判场景，我来练习 BATNA 分析"
       AI 扮演对手，实时给出反馈

5. 掌握追踪
   └─> 显示用户在各 Skill 上的熟练度
       建议下一步练习方向
```

### 2.5 技术栈建议

| 层级 | 技术选择 | 理由 |
|-----|---------|------|
| Frontend | Next.js + React | SSR、良好的开发体验 |
| Backend | Python FastAPI | 与 AI 生态集成好 |
| LLM | Claude API | 最强的指令遵循能力 |
| 文档解析 | PyMuPDF + python-docx | 成熟稳定 |
| 语音转文字 | Whisper | 开源、高质量 |
| 数据库 | PostgreSQL | 结构化数据 |
| 文件存储 | S3 / MinIO | 文档原件存储 |
| 缓存 | Redis | 会话、进度缓存 |

### 2.6 差异化优势

1. **输出导向**：不只是理解，而是生成可执行的技能
2. **实践模式**：提供模拟场景，让用户"做中学"
3. **进度追踪**：量化技能掌握程度
4. **技能库**：用户生成的 Skill 可以分享、复用
5. **与 Claude Code 打通**：生成的 Skill 可导出为 Claude Code Skill

---

## Part 3: 实施路线图

### Phase 1: 验证阶段 (skill-from-notebook)

**目标**: 验证"文档 → Skill"的核心逻辑

**工作内容**:
1. 实现 skill-from-notebook Claude Code Skill
2. 支持本地文档（PDF、Markdown）解析
3. 支持网页内容抓取
4. 生成符合 skill-creator 规范的 SKILL.md

**成功标准**:
- 从一篇技术教程生成可用的 Skill（方法论文档路径）
- 从一个方法论框架文章生成可用的 Skill（方法论文档路径）
- 从一篇优秀的技术博客逆向提取出写作 Skill（成品范例路径）

### Phase 2: 扩展阶段

**目标**: 丰富输入源，提升生成质量

**工作内容**:
1. 添加 YouTube 视频支持（Whisper 转录）
2. 添加 NotebookLM 集成（可选）
3. 优化方法论识别准确度
4. 添加 Skill 验证机制

### Phase 3: 产品化阶段 (SkillBookLM)

**目标**: 构建独立产品

**工作内容**:
1. 搭建 Web 应用框架
2. 实现用户系统和 Skill 库
3. 开发练习引擎
4. 设计进度追踪系统

---

## 附录 A: 与 NotebookLM 功能对比

### 输入源支持对比

| 输入类型 | NotebookLM | skill-from-notebook | 备注 |
|---------|-----------|------------------|------|
| PDF | ✅ | ✅ | 两者都支持 |
| Word (.docx) | ✅ | ✅ | 两者都支持 |
| 文本/Markdown | ✅ | ✅ | 两者都支持 |
| 网页 URL | ✅ 仅文本 | ✅ 仅文本 | 不含图片/嵌入视频 |
| YouTube | ✅ 需有字幕 | ✅ 字幕优先+Whisper | 我们更强（无字幕也能处理）|
| 音频文件 | ✅ 多格式 | ✅ 多格式 | Whisper 转录 |
| 图片 | ✅ | ✅ | Claude Vision |
| Google Docs/Slides/Sheets | ✅ | ❌ | Google 生态专属，不做 |
| 粘贴文本 | ✅ | ✅ | 两者都支持 |
| **NotebookLM 笔记链接** | N/A | ✅ | 利用 NotebookLM 已整理的内容 |
| **成品范例** | ❌ | ✅ | 逆向提取方法论（独有能力）|

### 核心差异

| 维度 | NotebookLM | SkillBookLM |
|-----|-----------|----------------|
| **定位** | 帮你理解 | 帮你会 |
| **输出** | Audio Overview, 摘要, FAQ | 可执行 Skill, 练习计划 |
| **交互** | 问答式 | 实践式 |
| **目标** | 消化内容 | 掌握技能 |

### NotebookLM 特有功能（参考）

- **Audio Overview**: 生成播客式音频摘要
- **Video Overview**: 支持 80 种语言的视频概览
- **Mind Map**: 交互式思维导图
- **Deep Research**: 自动化在线研究，生成报告

### NotebookLM 限制（参考）

- 每个 source 最多 500,000 字或 200MB
- 每个 notebook 最多 50 个 sources
- YouTube 视频必须有字幕
- 72 小时内上传的新视频可能无法导入
- 网页不支持付费墙内容

---

## 附录 B: 现有资源

可复用的组件：
- `skill-from-github` 的搜索和呈现逻辑
- `skill-creator` 的 Skill 规范和验证
- `notebooklm-skill` 的浏览器自动化方案

## 附录 C: 风险与应对

| 风险 | 影响 | 应对措施 |
|-----|-----|---------|
| 文档结构复杂 | 提取准确度下降 | 多轮对话澄清 |
| 方法论过于抽象 | 生成的 Skill 不可执行 | 引导用户提供具体案例 |
| NotebookLM API 变化 | 浏览器自动化失效 | 优先使用独立文档理解 |
| LLM 幻觉 | 生成错误步骤 | 添加验证环节，引用原文 |
